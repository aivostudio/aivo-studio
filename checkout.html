<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AIVO Checkout</title>

  <meta name="color-scheme" content="dark" />
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />

  <link rel="stylesheet" href="/studio.css?v=8" />
</head>

<body>

  <main class="checkout-page">
    <div class="checkout-shell">
      <section class="checkout-card">
        <header class="checkout-header">
          <h1 class="checkout-title">Checkout</h1>
          <p class="checkout-desc">Seçtiğin paketi doğrula ve ödemeyi tamamla.</p>
        </header>

        <div class="checkout-summary">
          <div class="checkout-row">
            <span class="checkout-label">Paket</span>
            <strong class="checkout-value" id="checkoutPlan">—</strong>
          </div>

          <div class="checkout-row">
            <span class="checkout-label">Tutar</span>
            <strong class="checkout-value" id="checkoutPrice">—</strong>
          </div>
        </div>

        <div class="checkout-actions" role="group" aria-label="Checkout işlemleri">
          <button class="btn btn-ghost" type="button" data-checkout-back>Geri</button>

          <!-- ÖNEMLİ: data-checkout-pay aynı kalsın -->
          <button class="btn btn-primary" type="button" data-checkout-pay>
            Ödemeye Geç
          </button>
        </div>

        <p class="checkout-note" id="checkoutNote" hidden></p>
      </section>
    </div>
  </main>

  <script>
    (function () {
      // URL parametreleri: ?plan=...&price=...
      var params = new URLSearchParams(window.location.search);
      var plan = params.get("plan") || "—";
      var price = params.get("price") || "—";

      var planEl = document.getElementById("checkoutPlan");
      var priceEl = document.getElementById("checkoutPrice");
      if (planEl) planEl.textContent = plan;
      if (priceEl) priceEl.textContent = price;

      // Basit closest fallback (Safari uyumlu)
      function closest(el, sel) {
        if (!el) return null;
        if (el.closest) return el.closest(sel);
        while (el && el.nodeType === 1) {
          if (el.matches && el.matches(sel)) return el;
          el = el.parentElement;
        }
        return null;
      }

      // Tek click listener: sadece Geri çalışsın (demo ödeme kaldırıldı)
      document.addEventListener("click", function (e) {
        var backBtn = closest(e.target, "[data-checkout-back]");
        if (backBtn) {
          e.preventDefault();
          window.history.back();
          return;
        }

        // Şimdilik ödeme butonu demo: hiçbir şey yapmasın (Stripe/iyzico sonra)
        var payBtn = closest(e.target, "[data-checkout-pay]");
        if (payBtn) {
          e.preventDefault();
          // İstersen şimdilik sadece log bırakabiliriz:
          console.log("[CHECKOUT] pay clicked (integration next)", { plan: plan, price: price });
          return;
        }
      });
    })();
  </script>

</body>
</html>
