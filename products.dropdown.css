/* =========================================================
   PRODUCTS + CORP DROPDOWN — SINGLE SOURCE (v8)
   Hedef:
   - Ürünler kartları KARE (aspect-ratio)
   - İkon asla yazının üstüne binmesin
   - Yazılar kart içine sığsın (clamp + line-clamp)
   - Kurumsal kartlar bozulmasın (mevcut güzel görünüm korunur)
   - Safari/overlap/blur sızıntıları kesilsin
   ========================================================= */

/* Topbar her zaman üstte */
.aivo-topbar{
  position: relative;
  z-index: 9000;
  isolation: isolate;
}

/* Dropdown anchor */
.nav-item.has-dropdown{ position: relative; }

/* ---------------------------------------------------------
   Dropdown container (ortak)
   --------------------------------------------------------- */
.dropdown{
  position: absolute;
  top: calc(100% + 12px);
  left: 50%;
  transform: translateX(-50%) translateY(6px);
  width: min(1100px, calc(100vw - 24px));
  padding: 14px;
  border-radius: 22px;

  /* OPAK CAM: arkadaki yazılar okunmasın */
  background: rgba(12, 14, 26, 0.92);
  border: 1px solid rgba(255,255,255,0.10);
  box-shadow: 0 18px 60px rgba(0,0,0,0.55);

  /* Safari/blur sızıntı önlemleri */
  overflow: hidden;
  -webkit-backdrop-filter: blur(16px);
  backdrop-filter: blur(16px);

  opacity: 0;
  pointer-events: none;
  transition: opacity .18s ease, transform .18s ease;
}

/* Açılma durumları (hangi JS modelin olursa olsun yakalasın) */
.nav-item.has-dropdown.is-open > .dropdown,
.nav-item.has-dropdown[aria-expanded="true"] > .dropdown,
.nav-item.has-dropdown:focus-within > .dropdown{
  opacity: 1;
  pointer-events: auto;
  transform: translateX(-50%) translateY(0);
}

/* Dropdown içindeki eski debug/pseudo overlay’leri öldür (çakışma varsa) */
.dropdown::before,
.dropdown::after{
  content: none !important;
}

/* ---------------------------------------------------------
   PRODUCTS dropdown
   --------------------------------------------------------- */
.dropdown--products .products-menu{
  display: grid;
  gap: 14px;
  grid-template-columns: repeat(5, minmax(0, 1fr));
  align-items: stretch;
}

/* Tablet: 3+2 */
@media (max-width: 980px){
  .dropdown--products .products-menu{
    grid-template-columns: repeat(3, minmax(0, 1fr));
  }
}
@media (max-width: 740px){
  .dropdown--products .products-menu{
    grid-template-columns: repeat(2, minmax(0, 1fr));
  }
}

/* Ürün kartı: KARE ve içerik alt-üst kilit */
.dropdown--products .product-card{
  /* RESET: başka css’lerden gelebilecek binmeleri iptal et */
  position: relative !important;
  transform: none !important;
  inset: auto !important;
  float: none !important;

  display: flex;
  flex-direction: column;
  justify-content: flex-start;

  padding: 16px 16px 14px;
  border-radius: 22px;

  aspect-ratio: 1 / 1;
  min-height: 170px;

  background: linear-gradient(135deg,
    rgba(120, 120, 255, 0.14),
    rgba(80, 220, 255, 0.06) 55%,
    rgba(10, 12, 22, 0.55)
  );

  border: 1px solid rgba(255,255,255,0.12);
  box-shadow: inset 0 0 0 1px rgba(255,255,255,0.04);
  text-decoration: none;
  color: inherit;

  overflow: hidden;
}

.dropdown--products .product-card:hover{
  border-color: rgba(170, 170, 255, 0.22);
  box-shadow:
    inset 0 0 0 1px rgba(255,255,255,0.06),
    0 10px 34px rgba(0,0,0,0.35);
}

/* İKON: kesinlikle yazıya binmesin */
.dropdown--products .product-card .pc-ico{
  /* RESET */
  position: static !important;
  transform: none !important;

  width: clamp(40px, 4.2vw, 52px);
  height: clamp(40px, 4.2vw, 52px);
  border-radius: 16px;

  display: inline-flex;
  align-items: center;
  justify-content: center;

  font-size: clamp(18px, 2.1vw, 24px);
  line-height: 1;

  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.10);
  box-shadow: inset 0 0 0 1px rgba(255,255,255,0.04);

  margin-bottom: 12px;
}

/* Metin bloğu: alta yapışsın (ikon üstte, yazı altta) */
.dropdown--products .product-card .pc-txt{
  display: flex;
  flex-direction: column;
  gap: 8px;

  margin-top: auto; /* kritik: yazı her zaman altta */
  min-width: 0;     /* taşma önle */
}

/* Başlık: büyük ama sığar */
.dropdown--products .product-card .pc-title{
  font-weight: 800;
  letter-spacing: -0.02em;
  line-height: 1.05;

  font-size: clamp(18px, 2.15vw, 28px);

  /* 2 satırı geçerse kırp */
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

/* Alt açıklama: 2 satır, asla taşmasın */
.dropdown--products .product-card .pc-sub{
  opacity: 0.72;
  line-height: 1.25;

  font-size: clamp(12px, 1.25vw, 15px);

  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

/* Her ihtimale karşı: product-card pseudo’larını kapat (bazı eski bloklar ekliyor) */
.dropdown--products .product-card::before,
.dropdown--products .product-card::after{
  content: none !important;
}

/* ---------------------------------------------------------
   CORP dropdown (mevcut iyi görünümü koru, sadece stabil yap)
   --------------------------------------------------------- */
.dropdown--corp .corp-grid{
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 14px;
  align-items: stretch;
}

@media (max-width: 740px){
  .dropdown--corp .corp-grid{ grid-template-columns: 1fr; }
}

.dropdown--corp .corp-card{
  display: flex;
  align-items: center;
  gap: 12px;

  padding: 14px 14px;
  border-radius: 18px;

  background: rgba(255,255,255,0.04);
  border: 1px solid rgba(255,255,255,0.10);
  text-decoration: none;
  color: inherit;

  min-height: 84px;
  overflow: hidden;
}

.dropdown--corp .corp-card:hover{
  border-color: rgba(170,170,255,0.18);
  background: rgba(255,255,255,0.05);
}

.dropdown--corp .corp-card .cc-ico{
  width: 40px;
  height: 40px;
  border-radius: 14px;

  display: inline-flex;
  align-items: center;
  justify-content: center;

  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.10);
  box-shadow: inset 0 0 0 1px rgba(255,255,255,0.04);

  font-size: 18px;
  line-height: 1;
}

.dropdown--corp .corp-card .cc-txt{
  min-width: 0;
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.dropdown--corp .corp-card .cc-title{
  font-weight: 800;
  letter-spacing: -0.01em;
  font-size: 18px;
  line-height: 1.1;

  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.dropdown--corp .corp-card .cc-sub{
  opacity: 0.72;
  font-size: 13px;
  line-height: 1.2;

  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
